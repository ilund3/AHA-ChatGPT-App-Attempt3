<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>American Heart Association</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html,
      body {
        width: 100%;
        height: 100%;
        background: #ffffff;
        display: flex;
        align-items: flex-start;
        justify-content: flex-start;
      }

      #bar-container {
        display: flex;
        flex-direction: column;
        width: 100%;
        height: auto;
        min-height: 0;
        padding: 0;
        background: #ffffff;
        border-bottom: none;
        transition: height 0.3s ease;
        overflow: visible;
      }

      #bar-container.expanded {
        overflow: visible;
      }

      #top-bar {
        display: none;
        align-items: center;
        justify-content: space-between;
        width: 100%;
        height: 70px;
        min-height: 70px;
        position: relative;
        overflow: visible !important;
      }

      #menu-wrapper {
        display: flex;
        align-items: center;
        height: 100%;
        overflow: visible;
        padding-left: 10px;
      }

      #hamburger-button {
        background: none;
        border: none;
        cursor: pointer;
        padding: 8px 8px 8px 12px;
        display: flex;
        flex-direction: column;
        justify-content: space-around;
        width: 40px;
        height: 30px;
        position: relative;
        overflow: visible;
        margin-left: 0;
      }

      #hamburger-button span {
        width: 100%;
        height: 3px;
        background-color: #DC143C;
        border-radius: 2px;
        transition: all 0.3s ease;
        transform-origin: center;
      }

      #hamburger-button.active span:nth-child(1) {
        width: 60%;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) rotate(45deg);
        margin-left: 3px;
      }

      #hamburger-button.active span:nth-child(2) {
        opacity: 0;
      }

      #hamburger-button.active span:nth-child(3) {
        width: 60%;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) rotate(-45deg);
        margin-left: 3px;
      }

      #emergency-text {
        flex: 1;
        text-align: right;
        padding-left: 20px;
      }
      
      #menu-items {
        display: none;
        flex-direction: row;
        align-items: center;
        gap: 0;
        padding: 0;
        margin-left: 20px;
      }

      #menu-items.active {
        display: flex;
      }
      
      #bar-container.expanded #emergency-text {
        display: none !important;
      }

      .menu-item {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 8px 16px;
        color: #495057;
        text-decoration: none;
        font-family: "Montserrat", "Helvetica Neue", Arial, sans-serif;
        font-size: 16px;
        font-weight: 500;
        cursor: pointer;
        white-space: nowrap;
        position: relative;
        transition: color 0.2s ease;
      }

      .menu-item::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 16px;
        right: 16px;
        height: 2px;
        background-color: #DC143C;
        opacity: 0;
        transition: opacity 0.2s ease;
      }

      .menu-item:hover {
        color: #495057;
      }

      .menu-item:hover::after {
        opacity: 1;
      }

      .menu-item.active {
        color: #495057;
      }

      .menu-item.active::after {
        opacity: 1;
      }

      #emergency-text {
        font-family: "Montserrat", "Helvetica Neue", Arial, sans-serif;
        font-size: 16px;
        color: #DC143C;
        font-weight: 500;
        text-align: right;
        padding-left: 20px;
        transition: opacity 0.3s ease, max-width 0.3s ease;
        overflow: hidden;
        white-space: nowrap;
      }

      #bar-container.expanded #emergency-text {
        display: none !important;
      }

      #emergency-text strong {
        font-weight: 600;
      }

      .tab-view {
        display: none;
        width: 100%;
        padding: 0;
        background: #ffffff;
        align-self: flex-start;
      }

      .tab-view.active {
        display: block;
      }

      /* Hide main navigation bar (hamburger menu) when any tab is active */
      #bar-container.has-active-tab #top-bar {
        display: none;
      }
      
      /* Always show tab navigation */
      .tab-nav {
        display: flex;
      }

      .tab-content {
        margin-top: 20px;
        padding: 0 20px 40px 20px;
      }

      .tab-content p {
        font-family: "Montserrat", "Helvetica Neue", Arial, sans-serif;
        font-size: 16px;
        color: #495057;
        line-height: 1.6;
      }

      #store-view {
        display: none;
        width: 100%;
        padding: 0;
        background: #ffffff;
      }

      #store-view.active {
        display: block;
      }

      .tab-nav {
        display: flex;
        flex-direction: row;
        align-items: center;
        gap: 0;
        padding: 20px 20px 12px 20px;
        margin: 0;
        border-bottom: 1px solid #e5e7eb;
        position: sticky;
        top: 0;
        background: #ffffff;
        z-index: 10;
      }

      .tab-nav-item {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 12px 16px;
        color: #495057;
        text-decoration: none;
        font-family: "Montserrat", "Helvetica Neue", Arial, sans-serif;
        font-size: 16px;
        font-weight: 500;
        cursor: pointer;
        white-space: nowrap;
        position: relative;
        transition: color 0.2s ease;
      }

      .tab-nav-item::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 16px;
        right: 16px;
        height: 2px;
        background-color: #DC143C;
        opacity: 0;
        transition: opacity 0.2s ease;
      }

      .tab-nav-item:hover {
        color: #495057;
      }

      .tab-nav-item:hover::after {
        opacity: 1;
      }

      .tab-nav-item.active {
        color: #495057;
      }

      .tab-nav-item.active::after {
        opacity: 1;
      }


      #store-content {
        padding: 20px;
      }

      .store-header {
        margin-bottom: 30px;
      }

      .store-header h1 {
        font-family: "Montserrat", "Helvetica Neue", Arial, sans-serif;
        font-size: 32px;
        font-weight: 700;
        color: #DC143C;
        margin-bottom: 10px;
      }

      .store-header p {
        font-family: "Montserrat", "Helvetica Neue", Arial, sans-serif;
        font-size: 16px;
        color: #6c757d;
      }

      .store-controls {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-bottom: 30px;
        align-items: center;
      }

      .search-box {
        flex: 1;
        min-width: 250px;
        position: relative;
      }

      .search-box input {
        width: 100%;
        padding: 12px 45px 12px 15px;
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        font-family: "Montserrat", "Helvetica Neue", Arial, sans-serif;
        font-size: 16px;
        transition: border-color 0.2s ease;
      }

      .search-box input:focus {
        outline: none;
        border-color: #DC143C;
      }

      .search-box::after {
        content: "üîç";
        position: absolute;
        right: 15px;
        top: 50%;
        transform: translateY(-50%);
        pointer-events: none;
      }

      .filter-group {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      .filter-select {
        padding: 12px 15px;
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        font-family: "Montserrat", "Helvetica Neue", Arial, sans-serif;
        font-size: 14px;
        background: #ffffff;
        cursor: pointer;
        transition: border-color 0.2s ease;
        min-width: 150px;
      }

      .filter-select:focus {
        outline: none;
        border-color: #DC143C;
      }

      .category-filters {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 2px solid #e5e7eb;
      }

      .category-filter-btn {
        padding: 10px 20px;
        border: 2px solid #e5e7eb;
        border-radius: 25px;
        background: #ffffff;
        font-family: "Montserrat", "Helvetica Neue", Arial, sans-serif;
        font-size: 14px;
        font-weight: 500;
        color: #495057;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .category-filter-btn:hover {
        border-color: #DC143C;
        color: #DC143C;
      }

      .category-filter-btn.active {
        background: #DC143C;
        border-color: #DC143C;
        color: #ffffff;
      }

      .store-results {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .store-results-count {
        font-family: "Montserrat", "Helvetica Neue", Arial, sans-serif;
        font-size: 14px;
        color: #6c757d;
      }

      #store-items {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 30px;
        margin-bottom: 40px;
      }

      .store-item {
        background: #ffffff;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        overflow: hidden;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        cursor: pointer;
        text-decoration: none;
        color: inherit;
        display: block;
      }

      .store-item:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        border-color: #DC143C;
      }

      .store-item-image {
        width: 100%;
        height: 250px;
        object-fit: cover;
        background: #f9fafb;
      }

      .store-item-badge {
        position: absolute;
        top: 10px;
        right: 10px;
        background: #DC143C;
        color: #ffffff;
        padding: 5px 12px;
        border-radius: 20px;
        font-family: "Montserrat", "Helvetica Neue", Arial, sans-serif;
        font-size: 12px;
        font-weight: 600;
      }

      .store-item-image-wrapper {
        position: relative;
      }

      .store-item-content {
        padding: 20px;
      }

      .store-item-category {
        font-family: "Montserrat", "Helvetica Neue", Arial, sans-serif;
        font-size: 12px;
        color: #6c757d;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 8px;
      }

      .store-item-title {
        font-family: "Montserrat", "Helvetica Neue", Arial, sans-serif;
        font-size: 18px;
        font-weight: 600;
        color: #1f2937;
        margin-bottom: 10px;
        line-height: 1.4;
      }

      .store-item-price {
        font-family: "Montserrat", "Helvetica Neue", Arial, sans-serif;
        font-size: 20px;
        font-weight: 700;
        color: #DC143C;
        margin-bottom: 10px;
      }

      .store-item-link {
        font-family: "Montserrat", "Helvetica Neue", Arial, sans-serif;
        font-size: 14px;
        color: #DC143C;
        font-weight: 500;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 5px;
      }

      .store-item-link:hover {
        text-decoration: underline;
      }

      .no-results {
        text-align: center;
        padding: 60px 20px;
        font-family: "Montserrat", "Helvetica Neue", Arial, sans-serif;
        color: #6c757d;
      }

      .no-results h3 {
        font-size: 24px;
        margin-bottom: 10px;
        color: #495057;
      }
    </style>
  </head>
  <body>
    <div id="bar-container">
      <div id="top-bar">
        <div id="menu-wrapper">
          <button id="hamburger-button" aria-label="Toggle menu">
            <span></span>
            <span></span>
            <span></span>
          </button>
        </div>
        <div id="emergency-text">
          If this is a life-threatening emergency, call <strong>911</strong> immediately.
        </div>
        <div id="menu-items">
          <a href="#" class="menu-item" data-action="store">Store</a>
          <a href="#" class="menu-item" data-action="support-groups">In Your Community</a>
          <a href="#" class="menu-item" data-action="volunteer">Get Involved</a>
          <a href="#" class="menu-item" data-action="saved">Saved</a>
          <a href="#" class="menu-item" data-action="discussions">Discussions</a>
        </div>
      </div>
      <div class="tab-nav">
        <a href="#" class="tab-nav-item" data-action="store">Store</a>
        <a href="#" class="tab-nav-item" data-action="support-groups">In Your Community</a>
        <a href="#" class="tab-nav-item" data-action="volunteer">Get Involved</a>
        <a href="#" class="tab-nav-item" data-action="saved">Saved</a>
        <a href="#" class="tab-nav-item" data-action="discussions">Discussions</a>
      </div>
      <div id="store-view" class="tab-view">
        <div id="store-content">
          <div class="store-controls">
            <div class="search-box">
              <input type="text" id="store-search" placeholder="Search products...">
            </div>
            <div class="filter-group">
              <select class="filter-select" id="sort-select">
                <option value="featured">Sort: Featured</option>
                <option value="price-low">Sort: Price Low to High</option>
                <option value="price-high">Sort: Price High to Low</option>
                <option value="name-asc">Sort: Name A-Z</option>
                <option value="name-desc">Sort: Name Z-A</option>
              </select>
            </div>
          </div>

          <div class="category-filters">
            <button class="category-filter-btn active" data-category="all">All Products</button>
            <button class="category-filter-btn" data-category="health-monitoring">Health Monitoring</button>
            <button class="category-filter-btn" data-category="exercise">Exercise Equipment</button>
            <button class="category-filter-btn" data-category="cookbooks">Cookbooks</button>
            <button class="category-filter-btn" data-category="aha-merch">AHA Merchandise</button>
            <button class="category-filter-btn" data-category="nutrition">Nutrition & Supplements</button>
            <button class="category-filter-btn" data-category="wellness">Wellness & Lifestyle</button>
          </div>

          <div class="store-results">
            <div class="store-results-count" id="results-count">Loading products...</div>
          </div>

          <div id="store-items"></div>
          <div id="no-results" class="no-results" style="display: none;">
            <h3>No products found</h3>
            <p>Try adjusting your search or filters</p>
          </div>
        </div>
      </div>
      <div id="support-groups-view" class="tab-view">
        <div class="tab-content">
          <p>Content for support groups...</p>
        </div>
      </div>
      <div id="volunteer-view" class="tab-view">
        <div class="tab-content">
          <p>Content for volunteer...</p>
        </div>
      </div>
      <div id="saved-view" class="tab-view">
        <div class="tab-content">
          <p>Content for saved items...</p>
        </div>
      </div>
      <div id="discussions-view" class="tab-view">
        <div class="tab-content">
          <p>Content for discussions...</p>
        </div>
      </div>
    </div>
    <script>
      (function() {
        const hamburgerButton = document.getElementById("hamburger-button");
        const menuItems = document.getElementById("menu-items");
        const barContainer = document.getElementById("bar-container");
        const menuItemLinks = document.querySelectorAll(".menu-item");

        // Function to notify ChatGPT of the widget's current height
        let heightNotifyTimeout = null;
        let lastNotifiedHeight = 0;
        function notifyHeight() {
          if (heightNotifyTimeout) {
            clearTimeout(heightNotifyTimeout);
          }
          
          heightNotifyTimeout = setTimeout(() => {
            if (window.openai?.notifyIntrinsicHeight && barContainer) {
              void barContainer.offsetHeight;
              const height = barContainer.scrollHeight;
              
              // Only notify if height actually changed to prevent loops
              if (Math.abs(height - lastNotifiedHeight) > 1) {
                lastNotifiedHeight = height;
                window.openai.notifyIntrinsicHeight(height);
              }
            }
          }, 50);
        }

        // Simple click handler
        if (hamburgerButton) {
          hamburgerButton.addEventListener("click", function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            hamburgerButton.classList.toggle("active");
            menuItems.classList.toggle("active");
            barContainer.classList.toggle("expanded");
            
            setTimeout(() => {
              notifyHeight();
            }, 300);
          });
        }

        const storeView = document.getElementById("store-view");
        const supportGroupsView = document.getElementById("support-groups-view");
        const volunteerView = document.getElementById("volunteer-view");
        const savedView = document.getElementById("saved-view");
        const discussionsView = document.getElementById("discussions-view");
        const allTabViews = [storeView, supportGroupsView, volunteerView, savedView, discussionsView];
        const tabNavItems = document.querySelectorAll(".tab-nav-item");

        // Function to show a specific tab
        function showTab(action) {
          // Hide all tabs
          allTabViews.forEach(view => {
            if (view) view.classList.remove("active");
          });

          // Show the selected tab
          let targetView = null;
          switch(action) {
            case "store":
              targetView = storeView;
              break;
            case "support-groups":
              targetView = supportGroupsView;
              break;
            case "volunteer":
              targetView = volunteerView;
              break;
            case "saved":
              targetView = savedView;
              break;
            case "discussions":
              targetView = discussionsView;
              break;
          }

          if (targetView) {
            targetView.classList.add("active");
          }

          // Update active states in all tab navs
          tabNavItems.forEach(item => {
            item.classList.remove("active");
            if (item.getAttribute("data-action") === action) {
              item.classList.add("active");
            }
          });

          // If showing store, trigger product render
          if (action === "store" && renderStoreProducts) {
            setTimeout(() => {
              renderStoreProducts();
            }, 100);
          }

          setTimeout(() => {
            notifyHeight();
          }, 100);
        }

        // Store render function (will be defined later)
        let renderStoreProducts = null;

        // Function to hide all tabs
        function hideAllTabs() {
          allTabViews.forEach(view => {
            if (view) view.classList.remove("active");
          });
          setTimeout(() => {
            notifyHeight();
          }, 100);
        }

        // Handle tab navigation clicks
        tabNavItems.forEach(item => {
          item.addEventListener("click", (e) => {
            e.preventDefault();
            const action = item.getAttribute("data-action");
            showTab(action);
          });
        });

        // Handle menu item clicks (if menu items are still accessible somehow)
        menuItemLinks.forEach((item) => {
          item.addEventListener("click", async (e) => {
            e.preventDefault();
            const action = item.getAttribute("data-action");
            
            // Show the selected tab
            showTab(action);
            
            setTimeout(() => {
              notifyHeight();
            }, 300);
          });
        });

        // Initial height notification
        setTimeout(() => {
          notifyHeight();
        }, 100);

        // Notify on window resize
        window.addEventListener("resize", () => {
          notifyHeight();
        });

        // Store functionality
        const storeProducts = [
          // Health Monitoring
          {
            id: 1,
            name: "Digital Kitchen Scale",
            category: "health-monitoring",
            price: 24.99,
            image: "https://m.media-amazon.com/images/I/91YrLTBnMcL._SL1500_.jpg",
            link: "https://amzn.to/4ilzm1q",
            featured: true
          },
          {
            id: 2,
            name: "Blood Pressure Monitor",
            category: "health-monitoring",
            price: 39.99,
            image: "https://m.media-amazon.com/images/I/71qJ8YVqFjL._AC_SL1500_.jpg",
            link: "https://amzn.to/example1",
            featured: true
          },
          {
            id: 3,
            name: "Smart Fitness Tracker",
            category: "health-monitoring",
            price: 79.99,
            image: "https://m.media-amazon.com/images/I/71Swqqe7XAL._AC_SX466_.jpg",
            link: "https://amzn.to/example2",
            featured: false
          },
          {
            id: 4,
            name: "Heart Rate Monitor Chest Strap",
            category: "health-monitoring",
            price: 49.99,
            image: "https://m.media-amazon.com/images/I/61+8m2oQ18L._AC_SL1500_.jpg",
            link: "https://amzn.to/example3",
            featured: false
          },
          // Exercise Equipment
          {
            id: 5,
            name: "High Density Foam Roller",
            category: "exercise",
            price: 19.99,
            image: "https://m.media-amazon.com/images/I/719fCtAm+hL._AC_SL1500_.jpg",
            link: "https://amzn.to/48gx8Md",
            featured: true
          },
          {
            id: 6,
            name: "Resistance Bands Set",
            category: "exercise",
            price: 24.99,
            image: "https://m.media-amazon.com/images/I/71+8m2oQ18L._AC_SL1500_.jpg",
            link: "https://amzn.to/example4",
            featured: false
          },
          {
            id: 7,
            name: "Yoga Mat Premium",
            category: "exercise",
            price: 34.99,
            image: "https://m.media-amazon.com/images/I/71Swqqe7XAL._AC_SL1500_.jpg",
            link: "https://amzn.to/example5",
            featured: false
          },
          {
            id: 8,
            name: "Adjustable Dumbbells",
            category: "exercise",
            price: 129.99,
            image: "https://m.media-amazon.com/images/I/71qJ8YVqFjL._AC_SL1500_.jpg",
            link: "https://amzn.to/example6",
            featured: false
          },
          {
            id: 9,
            name: "Walking Treadmill Desk",
            category: "exercise",
            price: 299.99,
            image: "https://m.media-amazon.com/images/I/61+8m2oQ18L._AC_SL1500_.jpg",
            link: "https://amzn.to/example7",
            featured: false
          },
          // Cookbooks
          {
            id: 10,
            name: "Heart Healthy Cookbook",
            category: "cookbooks",
            price: 18.99,
            image: "https://m.media-amazon.com/images/I/71nujH4E9BL._SL1293_.jpg",
            link: "https://amzn.to/4oiSvlQ",
            featured: true
          },
          {
            id: 11,
            name: "Mediterranean Diet Cookbook",
            category: "cookbooks",
            price: 16.99,
            image: "https://m.media-amazon.com/images/I/71Swqqe7XAL._AC_SL1500_.jpg",
            link: "https://amzn.to/example8",
            featured: false
          },
          {
            id: 12,
            name: "Low Sodium Recipe Collection",
            category: "cookbooks",
            price: 19.99,
            image: "https://m.media-amazon.com/images/I/71qJ8YVqFjL._AC_SL1500_.jpg",
            link: "https://amzn.to/example9",
            featured: false
          },
          {
            id: 13,
            name: "Plant-Based Heart Health Guide",
            category: "cookbooks",
            price: 22.99,
            image: "https://m.media-amazon.com/images/I/61+8m2oQ18L._AC_SL1500_.jpg",
            link: "https://amzn.to/example10",
            featured: false
          },
          // AHA Merchandise
          {
            id: 14,
            name: "AHA Red Heart T-Shirt",
            category: "aha-merch",
            price: 24.99,
            image: "https://m.media-amazon.com/images/I/71+8m2oQ18L._AC_SL1500_.jpg",
            link: "https://amzn.to/example11",
            featured: true,
            badge: "Official"
          },
          {
            id: 15,
            name: "AHA Awareness Wristband",
            category: "aha-merch",
            price: 4.99,
            image: "https://m.media-amazon.com/images/I/71Swqqe7XAL._AC_SL1500_.jpg",
            link: "https://amzn.to/example12",
            featured: false,
            badge: "Official"
          },
          {
            id: 16,
            name: "AHA Logo Water Bottle",
            category: "aha-merch",
            price: 19.99,
            image: "https://m.media-amazon.com/images/I/71qJ8YVqFjL._AC_SL1500_.jpg",
            link: "https://amzn.to/example13",
            featured: false,
            badge: "Official"
          },
          {
            id: 17,
            name: "AHA Heart Health Hoodie",
            category: "aha-merch",
            price: 44.99,
            image: "https://m.media-amazon.com/images/I/61+8m2oQ18L._AC_SL1500_.jpg",
            link: "https://amzn.to/example14",
            featured: false,
            badge: "Official"
          },
          // Nutrition & Supplements
          {
            id: 18,
            name: "Omega-3 Fish Oil Supplements",
            category: "nutrition",
            price: 29.99,
            image: "https://m.media-amazon.com/images/I/71+8m2oQ18L._AC_SL1500_.jpg",
            link: "https://amzn.to/example15",
            featured: false
          },
          {
            id: 19,
            name: "CoQ10 Heart Health Supplement",
            category: "nutrition",
            price: 34.99,
            image: "https://m.media-amazon.com/images/I/71Swqqe7XAL._AC_SL1500_.jpg",
            link: "https://amzn.to/example16",
            featured: false
          },
          {
            id: 20,
            name: "Magnesium Citrate Capsules",
            category: "nutrition",
            price: 19.99,
            image: "https://m.media-amazon.com/images/I/71qJ8YVqFjL._AC_SL1500_.jpg",
            link: "https://amzn.to/example17",
            featured: false
          },
          {
            id: 21,
            name: "Low Sodium Sea Salt Alternative",
            category: "nutrition",
            price: 12.99,
            image: "https://m.media-amazon.com/images/I/61+8m2oQ18L._AC_SL1500_.jpg",
            link: "https://amzn.to/example18",
            featured: false
          },
          // Wellness & Lifestyle
          {
            id: 22,
            name: "Stress Relief Essential Oil Diffuser",
            category: "wellness",
            price: 39.99,
            image: "https://m.media-amazon.com/images/I/71+8m2oQ18L._AC_SL1500_.jpg",
            link: "https://amzn.to/example19",
            featured: false
          },
          {
            id: 23,
            name: "Meditation Cushion Set",
            category: "wellness",
            price: 49.99,
            image: "https://m.media-amazon.com/images/I/71Swqqe7XAL._AC_SL1500_.jpg",
            link: "https://amzn.to/example20",
            featured: false
          },
          {
            id: 24,
            name: "Sleep Quality Tracker",
            category: "wellness",
            price: 89.99,
            image: "https://m.media-amazon.com/images/I/71qJ8YVqFjL._AC_SL1500_.jpg",
            link: "https://amzn.to/example21",
            featured: false
          },
          {
            id: 25,
            name: "Aromatherapy Stress Relief Kit",
            category: "wellness",
            price: 24.99,
            image: "https://m.media-amazon.com/images/I/61+8m2oQ18L._AC_SL1500_.jpg",
            link: "https://amzn.to/example22",
            featured: false
          }
        ];

        let filteredProducts = [...storeProducts];
        let currentCategory = "all";
        let currentSort = "featured";
        let currentSearch = "";

        const storeItemsContainer = document.getElementById("store-items");
        const storeSearch = document.getElementById("store-search");
        const sortSelect = document.getElementById("sort-select");
        const categoryFilterBtns = document.querySelectorAll(".category-filter-btn");
        const resultsCount = document.getElementById("results-count");
        const noResults = document.getElementById("no-results");

        function renderProducts() {
          // Filter by category
          let products = currentCategory === "all" 
            ? [...storeProducts] 
            : storeProducts.filter(p => p.category === currentCategory);

          // Filter by search
          if (currentSearch.trim()) {
            const searchLower = currentSearch.toLowerCase();
            products = products.filter(p => 
              p.name.toLowerCase().includes(searchLower)
            );
          }

          // Sort products
          products.sort((a, b) => {
            switch(currentSort) {
              case "price-low":
                return a.price - b.price;
              case "price-high":
                return b.price - a.price;
              case "name-asc":
                return a.name.localeCompare(b.name);
              case "name-desc":
                return b.name.localeCompare(a.name);
              case "featured":
              default:
                return (b.featured ? 1 : 0) - (a.featured ? 1 : 0);
            }
          });

          filteredProducts = products;

          // Update results count
          const count = products.length;
          resultsCount.textContent = `${count} product${count !== 1 ? 's' : ''} found`;

          // Show/hide no results
          if (products.length === 0) {
            storeItemsContainer.style.display = "none";
            noResults.style.display = "block";
          } else {
            storeItemsContainer.style.display = "grid";
            noResults.style.display = "none";
          }

          // Render products
          storeItemsContainer.innerHTML = products.map(product => {
            const categoryNames = {
              "health-monitoring": "Health Monitoring",
              "exercise": "Exercise Equipment",
              "cookbooks": "Cookbooks",
              "aha-merch": "AHA Merchandise",
              "nutrition": "Nutrition & Supplements",
              "wellness": "Wellness & Lifestyle"
            };

            return `
              <a href="${product.link}" target="_blank" class="store-item" rel="noopener noreferrer" data-product-id="${product.id}">
                <div class="store-item-image-wrapper">
                  <img src="${product.image}" alt="${product.name}" class="store-item-image">
                  ${product.badge ? `<div class="store-item-badge">${product.badge}</div>` : ''}
                </div>
                <div class="store-item-content">
                  <div class="store-item-category">${categoryNames[product.category] || product.category}</div>
                  <div class="store-item-title">${product.name}</div>
                  <div class="store-item-price">$${product.price.toFixed(2)}</div>
                  <div class="store-item-link">View on Amazon ‚Üí</div>
                </div>
              </a>
            `;
          }).join('');

          // Notify height after images have a chance to load
          setTimeout(() => {
            notifyHeight();
          }, 300);
        }

        // Search functionality
        if (storeSearch) {
          storeSearch.addEventListener("input", (e) => {
            currentSearch = e.target.value;
            renderProducts();
          });
        }

        // Sort functionality
        if (sortSelect) {
          sortSelect.addEventListener("change", (e) => {
            currentSort = e.target.value;
            renderProducts();
          });
        }

        // Category filter functionality
        categoryFilterBtns.forEach(btn => {
          btn.addEventListener("click", () => {
            categoryFilterBtns.forEach(b => b.classList.remove("active"));
            btn.classList.add("active");
            currentCategory = btn.getAttribute("data-category");
            renderProducts();
          });
        });

        // Initial render
        renderProducts();

        // Store the render function for use in showTab
        renderStoreProducts = renderProducts;
      })();
    </script>
  </body>
</html>

